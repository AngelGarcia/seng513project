var dbAccess = require('dbAccess');
var url = require('url');

var ViewProfile = exports.ViewProfile = function() {};

/**
 * Display a profile page
 * @param request Request object from the client
 * @param response Response object to send the data
 */
ViewProfile.display = function(request, response)
{
//    var parsedURL = url.parse(request.url, true);
//	var id = parsedURL.query["id"];
//	dbAccess.find('users', { conditions:['id="' + id + '"'] }, function(error, results) 
	request.getUser(function(error, user)
	{
		if(error)
			throw error;
		
		if(!user)
		{
			response.write('<h1>User Not Found</h1>');
		}
		else
		{
			variables = {
				name: user.name,
				neighborhood: user.neighborhood || '',
				postal_code: user.postal_code || '',
				facebook_account: user.facebook_account || 'None',
				twitter_account: user.twitter_account || 'None'
			}
			
			response.render('views/viewProfile.html', variables);
		}
	});
}
