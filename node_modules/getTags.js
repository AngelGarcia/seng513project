/* GetTags.js 
 * Author: Russell Kubik
 * An ajax request will call this search function and will in return receive a JSON formatted list of relevant tags
 */ 

var dbAccess = require('dbAccess'), 
	url = require('url');

var GetTags = exports.GetTags = function() {};

/**
 * Search a partial tag
 */
GetTags.search = function(request, response) {
	var parsedURL = url.parse(request.url, true);
	var term = parsedURL.query.term;
	dbAccess.runQuery("SELECT * FROM tags WHERE tag LIKE '%"+term+"%'", function(error, rows) {
		var results = [rows.length];
		for(var i=0; i<rows.length;i++)
			results[i] = rows[i].tag;
		response.writeHead(200, {'content-type': 'text/json' });
        response.write( JSON.stringify(results) );
        response.end();
	});
}
