var util = require('util'),
	path = require('path');

var s;


var loadSettings = function(settingsFile, callback) {
	// Try to load the settings from the file
	path.exists(settingsFile, function (exists) {
		if (exists) {
			eval(fs.readFileSync('config.js', encoding="ascii"));
			util.log(s.db_file);
			util.log(s.email_account);
			util.log('Loaded application settings from ' + settingsFile);
		}
		else {
			util.log(settingsFile + ' not found. Using default settings.');
		}
		
		// Define defaults here.
		if (!settings.db_file)
			settings.db_file = 'db/CivicConnect.db';
		if (!settings.email_account)
			settings.email_account = 'civicconnect@gmail.com';
		if (!settings.email_password)
			settings.email_password = '';
		
		if (callback instanceof Function) callback();
	});
}

if (!s) {
	// Try to load the settings from the file
	path.exists('config.js', function (exists) {
		if (exists) {
			eval(fs.readFileSync('config.js', encoding="ascii"));
			util.log(s.db_file);
			util.log(s.email_account);
			util.log('Loaded application settings from config.js');
		}
		else {
			var s = '';
			util.log('config.js not found. Using default settings.');
		}
		
		// Define defaults here.
		if (!s.db_file)
			s.db_file = 'db/CivicConnect.db';
		if (!s.email_account)
			s.email_account = 'civicconnect@gmail.com';
		if (!s.email_password)
			s.email_password = '';
		
		module.exports = s;
		util.log('read');
	});
}
else {
	util.log('not reading');
}
this.settings = s;
